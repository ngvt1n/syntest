<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>SYNTEST – Color Test</title>

  <!-- === Fonts === -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link
    href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800;900&display=swap"
    rel="stylesheet"
  />

  <!-- === Core Stylesheet === -->
  <!-- Versioned for cache busting -->
  <link
    rel="stylesheet"
    href="{{ url_for('static', filename='color.css') }}?v=8"
  />
</head>

<body class="page-color">
  <!-- ============================================================
       TOP BAR — Branding + Help Button
       ============================================================ -->
  <div class="topbar">
    <div class="brand">SYNTEST</div>
    <div class="top-right">
      <button
        class="btn"
        id="helpBtn"
        type="button"
        aria-haspopup="dialog"
      >
        Help
      </button>
    </div>
  </div>

  <!-- ============================================================
       MAIN CARD — Color Test Interface
       ============================================================ -->
  <main class="shell" role="main">
    <div class="content">
      <!-- Section Header -->
      <header class="hdr">
        <h1>COLOR TEST: CONSISTENCY &amp; SPEED</h1>
        <p class="sub">
          You’ll assign colors to items <b>three times each</b>.
          Use a laptop/desktop; turn off blue-light filters.
        </p>
      </header>

      <!-- ============================================================
           CCT SECTION — Consistency Color Test UI
           ============================================================ -->
      <section class="block" aria-labelledby="cct-heading">
        <h2 id="cct-heading" class="block-title">CONSISTENCY TEST</h2>

        <!-- --- Trial Status Readout --- -->
        <div class="status" aria-live="polite">
          <div>Item: <span id="stimulusLabel">—</span></div>
          <div>Trial <span id="trialNum">1</span> / <span id="trialTotal">3</span></div>
          <div>Progress <span id="progress">0/0</span></div>
        </div>

        <!-- ============================================================
             TEST WORK AREA
             - Left: Color Picker (wheel)
             - Middle: Stimulus (word/letter/number)
             - Right: Color Preview + Navigation
             ============================================================ -->
        <div id="cctContainer" class="cct-grid">
          <!-- === COLOR PICKER === -->
          <div class="wheel-wrap">
            <div style="position: relative">
              <!-- Interactive color field -->
              <canvas
                id="wheel"
                width="360"
                height="360"
                aria-label="Color selection area"
              ></canvas>
              <!-- Dot shows current color sample -->
              <span class="dot" id="dot" aria-hidden="true"></span>
            </div>

            <!-- Optional action (no color) -->
            <div class="wheel-actions">
              <button id="btnNone" class="btn" type="button">No color</button>
            </div>
          </div>

          <!-- === STIMULUS BOX (Center Display) === -->
          <div
            id="stimulusBox"
            class="stimulus-box"
            aria-label="Stimulus"
          >
            <div id="stimulusContent">—</div>
          </div>

          <!-- === COLOR PREVIEW + NAVIGATION === -->
          <div class="swatch-wrap">
            <!-- Selected color swatch -->
            <div
              class="swatch"
              id="swatch"
              aria-label="Selected color preview"
            >
              <div class="hex" id="hex">———</div>
            </div>

            <!-- Navigation controls -->
            <div class="nav">
              <button
                id="btnNext"
                class="btn btn-primary"
                type="button"
              >
                Next →
              </button>
            </div>

            <!-- Brief instructions -->
            <p class="tip">
              Move over the wheel to select.
              Press <b>N</b> to toggle “No color”.
            </p>
          </div>
        </div>

        <!-- Developer/Researcher slider for jumping between trial blocks -->
        <div class="trial-slider-container" aria-hidden="true">
          <label for="trialSlider"><b>Trial:</b></label>
          <input
            type="range"
            id="trialSlider"
            min="1"
            max="3"
            value="1"
            step="1"
          />
        </div>
      </section>

      <!-- ============================================================
           SUMMARY — Revealed after completion of all trials
           ============================================================ -->
      <section id="cctSummary" class="summary hidden"></section>
    </div>
  </main>

  <!-- ============================================================
       HELP DIALOG — Opens when user clicks “Help”
       ============================================================ -->
  <dialog
    id="helpDialog"
    class="help"
    aria-labelledby="helpTitle"
  >
    <h3 id="helpTitle">Quick Help</h3>
    <ul>
      <li>Look at the stimulus in the middle (number, letter, or word).</li>
      <li>Pick the color on the square that best matches your automatic experience.</li>
      <li>Use “No color” if you have none for that item.</li>
      <li>Each item repeats 3× in random order.</li>
    </ul>
    <div class="dlg-actions">
      <button
        id="helpClose"
        class="btn btn-primary"
        type="button"
      >
        OK
      </button>
    </div>
  </dialog>

  <!-- ============================================================
       SCRIPT — Client-side Color Test Logic
       ============================================================ -->
  <script src="{{ url_for('static', filename='color.js') }}"></script>
</body>
</html>
